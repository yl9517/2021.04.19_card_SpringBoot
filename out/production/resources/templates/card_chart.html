<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" href="../static/css/header.css" />
    <link rel="stylesheet" href="../static/css/card_chart.css" />
    <link rel="stylesheet" href="../static/css/footer.css" />

</head>

<body>
    <th:block th:replace = "/header :: header"></th:block>


    <div id="chartWrap">
            <div id="subtitle">
                <h1> 카드 TOP10 </h1>
            </div>

           <div id="chartInfo">
               <ul>
                   <li id="onechart" th:each="rank, i : ${rankList}"> <!--반복문-->
                       <p class="rank" th:text="${i.index+1}"> </p>
                       <img th:src="@{../static/images/} + ${rank.cardPhoto}"/><!--사진-->
                       <div class="text">
                           <p class="name" th:for="${rank.cardCode}" th:text="${rank.cardName}"></p> <!--카드이름-->
                           <p th:text="${rank.cardCompany}"></p> <!--카드사-->
                       </div>
                       <div id="ex">
                           <a href="card_detail.html" th:href="@{'/card_detail_page/'+${rank.cardCode}}" class="more"> 상세 보기</a>
                           <a class="cart" onclick='getRadioText(event)' th:id="${rank.cardCode}"> 비교함 담기</a>
                       </div>
                   </li>

               </ul>

           </div>
    </div>
    <form id="comparebox" action="/card_compare_page">
        <ul>
            <li>
                <input id="result" name="result">
                <a class="delete_btn">x</a>
            </li>
            <li>
                <input id="result2" name="result2">
                <a class="delete_btn">x</a>
            </li>
        </ul>
        <input type="submit" class="compare_go" href="card_compare.html" th:href="@{/card_compare_page}" value="비교하기">
    </form>
    <script type="text/javascript">
        function getRadioText(event){
            const radioId = event.target.id;
            const query = 'p[for="'+radioId+'"]' //p태그의 for="아이디" 가져오기 //이때 아이디는 위에서 선언

            const text = document.querySelector(query).innerText; //innerText : 태그 사이에 텍스트를 넣겠다.

            if(document.getElementById('result').innerText==text || document.getElementById('result2').innerText==text){
                alert('이미 비교함에 있는 카드입니다.');
                return false;
            }
            if(document.getElementById('result').innerText!="" && document.getElementById('result2').innerText!=""){
                alert('비교함이 가득 차있습니다. 비교함을 비우고 다시 담아주세요.');
                return false;
            }

            if(document.getElementById('result').innerText==""){
                document.getElementById('result').innerText = text;
                document.getElementById('result').value = text;
            }else{
                document.getElementById('result2').innerText = text;
                document.getElementById('result2').value = text;
            }


        }

    </script>

    <th:block th:replace = "/footer :: footer"></th:block>

</body>
</html>